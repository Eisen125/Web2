{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Almog\\\\GITprojects\\\\web2-effi\\\\Web2\\\\web-2\\\\frontend\\\\src\\\\components\\\\RecommendedProduct.js\",\n  _s = $RefreshSig$();\nimport axios from 'axios';\nimport React, { useState, useEffect, useContext, useReducer } from 'react';\nimport { Store } from '../Store';\nimport { getError } from '../utils';\nimport Product from './Product';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst reducer = (state, action) => {\n  switch (action.type) {\n    case 'FETCH_REQUEST':\n      return {\n        ...state,\n        loading: true\n      };\n    case 'FETCH_SUCCESS':\n      return {\n        ...state,\n        products: action.payload.products,\n        page: action.payload.page,\n        pages: action.payload.pages,\n        countProducts: action.payload.countProducts,\n        loading: false\n      };\n    default:\n      return state;\n  }\n};\nconst RecommendedProduct = () => {\n  _s();\n  const {\n    cartItems\n  } = useContext(Store);\n  const [recommendedProduct, setRecommendedProduct] = useState(false);\n  const cartProductIds = cartItems.map(item => item.id);\n  const cpc = cartItems.map(item => item.category);\n  const RandCategory = cpc[Math.floor(Math.random() * cpc.length)];\n  const [{\n    error,\n    products\n  }, dispatch] = useReducer(reducer, {\n    loading: true,\n    error: ''\n  });\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const {\n          data\n        } = await axios.get(`/api/products/search?page='1'&query='all'&category=${RandCategory}&price='all'&rating=$'all'&order='newest'`);\n        dispatch({\n          type: 'FETCH_SUCCESS',\n          payload: data\n        });\n      } catch (err) {}\n    };\n    fetchData();\n  }, [error, RandCategory]);\n  useEffect(() => {\n    products.then(result => {\n      setRecommendedProduct(false);\n      result.data.some(product => {\n        if (!cartProductIds.includes(product.id)) {\n          setRecommendedProduct(product);\n          return true;\n        }\n        return false;\n      });\n    });\n  }, [products, cartProductIds]);\n  if (recommendedProduct) {\n    return /*#__PURE__*/_jsxDEV(Product, {\n      product: recommendedProduct\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 63,\n      columnNumber: 12\n    }, this);\n  }\n};\n_s(RecommendedProduct, \"Q1tcf4u8XzZvGB1benKvJp1AuCA=\");\n_c = RecommendedProduct;\nexport default RecommendedProduct;\nvar _c;\n$RefreshReg$(_c, \"RecommendedProduct\");","map":{"version":3,"names":["axios","React","useState","useEffect","useContext","useReducer","Store","getError","Product","reducer","state","action","type","loading","products","payload","page","pages","countProducts","RecommendedProduct","cartItems","recommendedProduct","setRecommendedProduct","cartProductIds","map","item","id","cpc","category","RandCategory","Math","floor","random","length","error","dispatch","fetchData","data","get","err","then","result","some","product","includes"],"sources":["C:/Users/Almog/GITprojects/web2-effi/Web2/web-2/frontend/src/components/RecommendedProduct.js"],"sourcesContent":["import axios from 'axios';\nimport React, { useState, useEffect, useContext, useReducer } from 'react';\nimport { Store } from '../Store';\nimport { getError } from '../utils';\nimport Product from './Product';\n\nconst reducer = (state, action) => {\n  switch (action.type) {\n    case 'FETCH_REQUEST':\n      return { ...state, loading: true };\n    case 'FETCH_SUCCESS':\n      return {\n        ...state,\n        products: action.payload.products,\n        page: action.payload.page,\n        pages: action.payload.pages,\n        countProducts: action.payload.countProducts,\n        loading: false,\n      };\n    default:\n      return state;\n  }\n};\n\nconst RecommendedProduct = () => {\n  const { cartItems } = useContext(Store);\n  const [recommendedProduct, setRecommendedProduct] = useState(false);\n  const cartProductIds = cartItems.map((item) => item.id);\n  const cpc = cartItems.map((item) => item.category);\n  const RandCategory = cpc[Math.floor(Math.random() * cpc.length)];\n\n  const [{ error, products }, dispatch] = useReducer(reducer, {\n    loading: true,\n    error: '',\n  });\n\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const { data } = await axios.get(\n          `/api/products/search?page='1'&query='all'&category=${RandCategory}&price='all'&rating=$'all'&order='newest'`\n        );\n        dispatch({ type: 'FETCH_SUCCESS', payload: data });\n      } catch (err) {}\n    };\n    fetchData();\n  }, [error, RandCategory]);\n\n  useEffect(() => {\n    products.then((result) => {\n      setRecommendedProduct(false);\n      result.data.some((product) => {\n        if (!cartProductIds.includes(product.id)) {\n          setRecommendedProduct(product);\n          return true;\n        }\n        return false;\n      });\n    });\n  }, [products, cartProductIds]);\n\n  if (recommendedProduct) {\n    return <Product product={recommendedProduct}></Product>;\n  }\n};\n\nexport default RecommendedProduct;\n"],"mappings":";;AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,OAAOC,KAAK,IAAIC,QAAQ,EAAEC,SAAS,EAAEC,UAAU,EAAEC,UAAU,QAAQ,OAAO;AAC1E,SAASC,KAAK,QAAQ,UAAU;AAChC,SAASC,QAAQ,QAAQ,UAAU;AACnC,OAAOC,OAAO,MAAM,WAAW;AAAC;AAEhC,MAAMC,OAAO,GAAG,CAACC,KAAK,EAAEC,MAAM,KAAK;EACjC,QAAQA,MAAM,CAACC,IAAI;IACjB,KAAK,eAAe;MAClB,OAAO;QAAE,GAAGF,KAAK;QAAEG,OAAO,EAAE;MAAK,CAAC;IACpC,KAAK,eAAe;MAClB,OAAO;QACL,GAAGH,KAAK;QACRI,QAAQ,EAAEH,MAAM,CAACI,OAAO,CAACD,QAAQ;QACjCE,IAAI,EAAEL,MAAM,CAACI,OAAO,CAACC,IAAI;QACzBC,KAAK,EAAEN,MAAM,CAACI,OAAO,CAACE,KAAK;QAC3BC,aAAa,EAAEP,MAAM,CAACI,OAAO,CAACG,aAAa;QAC3CL,OAAO,EAAE;MACX,CAAC;IACH;MACE,OAAOH,KAAK;EAAC;AAEnB,CAAC;AAED,MAAMS,kBAAkB,GAAG,MAAM;EAAA;EAC/B,MAAM;IAAEC;EAAU,CAAC,GAAGhB,UAAU,CAACE,KAAK,CAAC;EACvC,MAAM,CAACe,kBAAkB,EAAEC,qBAAqB,CAAC,GAAGpB,QAAQ,CAAC,KAAK,CAAC;EACnE,MAAMqB,cAAc,GAAGH,SAAS,CAACI,GAAG,CAAEC,IAAI,IAAKA,IAAI,CAACC,EAAE,CAAC;EACvD,MAAMC,GAAG,GAAGP,SAAS,CAACI,GAAG,CAAEC,IAAI,IAAKA,IAAI,CAACG,QAAQ,CAAC;EAClD,MAAMC,YAAY,GAAGF,GAAG,CAACG,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,MAAM,EAAE,GAAGL,GAAG,CAACM,MAAM,CAAC,CAAC;EAEhE,MAAM,CAAC;IAAEC,KAAK;IAAEpB;EAAS,CAAC,EAAEqB,QAAQ,CAAC,GAAG9B,UAAU,CAACI,OAAO,EAAE;IAC1DI,OAAO,EAAE,IAAI;IACbqB,KAAK,EAAE;EACT,CAAC,CAAC;EAEF/B,SAAS,CAAC,MAAM;IACd,MAAMiC,SAAS,GAAG,YAAY;MAC5B,IAAI;QACF,MAAM;UAAEC;QAAK,CAAC,GAAG,MAAMrC,KAAK,CAACsC,GAAG,CAC7B,sDAAqDT,YAAa,2CAA0C,CAC9G;QACDM,QAAQ,CAAC;UAAEvB,IAAI,EAAE,eAAe;UAAEG,OAAO,EAAEsB;QAAK,CAAC,CAAC;MACpD,CAAC,CAAC,OAAOE,GAAG,EAAE,CAAC;IACjB,CAAC;IACDH,SAAS,EAAE;EACb,CAAC,EAAE,CAACF,KAAK,EAAEL,YAAY,CAAC,CAAC;EAEzB1B,SAAS,CAAC,MAAM;IACdW,QAAQ,CAAC0B,IAAI,CAAEC,MAAM,IAAK;MACxBnB,qBAAqB,CAAC,KAAK,CAAC;MAC5BmB,MAAM,CAACJ,IAAI,CAACK,IAAI,CAAEC,OAAO,IAAK;QAC5B,IAAI,CAACpB,cAAc,CAACqB,QAAQ,CAACD,OAAO,CAACjB,EAAE,CAAC,EAAE;UACxCJ,qBAAqB,CAACqB,OAAO,CAAC;UAC9B,OAAO,IAAI;QACb;QACA,OAAO,KAAK;MACd,CAAC,CAAC;IACJ,CAAC,CAAC;EACJ,CAAC,EAAE,CAAC7B,QAAQ,EAAES,cAAc,CAAC,CAAC;EAE9B,IAAIF,kBAAkB,EAAE;IACtB,oBAAO,QAAC,OAAO;MAAC,OAAO,EAAEA;IAAmB;MAAA;MAAA;MAAA;IAAA,QAAW;EACzD;AACF,CAAC;AAAC,GAxCIF,kBAAkB;AAAA,KAAlBA,kBAAkB;AA0CxB,eAAeA,kBAAkB;AAAC;AAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}